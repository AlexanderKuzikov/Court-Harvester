# Court-Harvester üåæ

CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å—É–¥–æ–≤ –†–§ —á–µ—Ä–µ–∑ API DaData.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–ü–æ–ª–Ω—ã–π –æ—Ö–≤–∞—Ç:** –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–º —Å—É–¥–∞–º, —Å—É–¥–∞–º –æ–±—â–µ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏ –∏ –º–∏—Ä–æ–≤—ã–º —Å—É–¥—å—è–º.
*   **–£–º–Ω—ã–π —Å–±–æ—Ä:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ö–æ–¥–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ —Ç–∏–ø–∞–º —Å—É–¥–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø–æ–ª–Ω–æ—Ç—ã –±–∞–∑—ã.
*   **–°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤:** –ñ–µ—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–≤–æ—Ç API (10 000 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å—É—Ç–∫–∏) –∏ rate-limiting (20 req/sec), —á—Ç–æ–±—ã –Ω–µ –ø–æ–ª—É—á–∏—Ç—å –±–∞–Ω.
*   **–≠–∫—Å–ø–æ—Ä—Ç:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON/CSV/Excel, –≥–æ—Ç–æ–≤—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ 1–°, CRM –∏–ª–∏ Excel.
*   **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —á–µ–∫–ø–æ–∏–Ω—Ç—ã (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–∞—É–∑—É –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤.

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

*   **Runtime:** Node.js 18+
*   **Language:** TypeScript 5.7
*   **HTTP Client:** Axios + axios-retry
*   **Rate Limiting:** Bottleneck
*   **CLI:** Commander.js
*   **Data Processing:** ExcelJS, csv-stringify

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/AlexanderKuzikov/Court-Harvester.git
    cd Court-Harvester
    ```

2.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    npm install
    ```

3.  –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏–∑ —à–∞–±–ª–æ–Ω–∞:
    ```bash
    cp .env.example .env
    ```

4.  –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ API-–∫–ª—é—á–∏ DaData:
    ```ini
    DADATA_API_KEY=–≤–∞—à_api_–∫–ª—é—á
    DADATA_SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
    ```
    *(–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á–∏ –º–æ–∂–Ω–æ –≤ [–ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ DaData](https://dadata.ru/profile/#info))*

5.  –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ TypeScript:
    ```bash
    npm run build
    ```

## üß™ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢–µ—Å—Ç API –∫–ª–∏–µ–Ω—Ç–∞
```bash
npm run dev -- src/examples/test-client.ts
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π:
- –ù–∞–π–¥–µ—Ç —Å—É–¥—ã –ü–µ—Ä–º—Å–∫–æ–≥–æ –∫—Ä–∞—è
- –ù–∞–π–¥–µ—Ç –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ —Å—É–¥—ã
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç rate limiting –Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–∞–±–æ—Ç—ã

## üèÉ‚Äç‚ôÇÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É —Ä–µ–≥–∏–æ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π)
```bash
npm start -- --region 59
```

### –ü–æ–ª–Ω—ã–π —Å–±–æ—Ä –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏ (—Å —É—á–µ—Ç–æ–º –ª–∏–º–∏—Ç–æ–≤)
```bash
npm start -- --full
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Excel
```bash
npm run export -- --format xlsx --output courts_rf.xlsx
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Court-Harvester/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ApiClient.ts      # ‚úÖ –Ø–¥—Ä–æ: HTTP-–∫–ª–∏–µ–Ω—Ç —Å rate limiting
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dadata.ts          # ‚úÖ TypeScript —Ç–∏–ø—ã –¥–ª—è DaData API
‚îÇ   ‚îî‚îÄ‚îÄ examples/
‚îÇ       ‚îî‚îÄ‚îÄ test-client.ts     # ‚úÖ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ApiClient
‚îú‚îÄ‚îÄ .env.example               # ‚úÖ –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ package.json               # ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ tsconfig.json              # ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript
‚îî‚îÄ‚îÄ README.md                  # ‚úÖ –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ApiClient

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **Rate Limiting (Bottleneck)**
   - Reservoir: 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç—ã –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
   - –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (max 5)

2. **Retry Logic (axios-retry)**
   - –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
   - –ü–æ–≤—Ç–æ—Ä—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –∏ 5xx
   - –ù–ï –ø–æ–≤—Ç–æ—Ä—è–µ—Ç 403 (quota exceeded) –∏ 4xx

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–≤–æ—Ç**
   - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å `QuotaExceededError` –¥–ª—è 403
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—à–∏–±–∫–∞–º –∫–≤–æ—Ç—ã

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - `getStats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - `getLimiterStatus()` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
   - `shutdown()` - graceful –æ—Å—Ç–∞–Ω–æ–≤–∫–∞

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ dev-—Ä–µ–∂–∏–º–µ
```bash
npm run dev
```

### –õ–∏–Ω—Ç–∏–Ω–≥
```bash
npm run lint
```

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
npm run format
```

## üìã TODO

- [ ] Harvester Engine (—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–±–æ—Ä–∞)
- [ ] Storage Layer (JSON persistence)
- [ ] CLI Interface (Commander.js)
- [ ] Export Module (CSV/Excel)
- [ ] Unit Tests (Vitest)
- [ ] CI/CD (GitHub Actions)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π [Apache-2.0](LICENSE).
